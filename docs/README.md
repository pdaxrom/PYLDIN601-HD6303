# Новый Пълдин-601

Это проект 8-битного компьютера, программно совместимого с Пълдин-601 на уровне приложений. Проект включает в себя не только аппаратную часть, но и BIOS, системные ПЗУ, операционную систему и утилиты для работы с обновленным железом.

[Плата процессора](#плата-процессора)

[Плата периферии](#плата-периферии)

## Плата процессора

Текущая версия 1.2.

На плате находится процессор, озу, пзу и адресный декодер. Возможно автономное использование платы без дополнительных плат периферии.

[Карта адресного пространства](#карта-адресного-пространства)

[Управление адресным пространством и страницами памяти](#управление-адресным-пространством-и-страницами-памяти)

[Шина расширения](#шина-расширения)

[Порт ввода-вывода](#порт-ввода-вывода)

[Главное отличие от Пълдин-601](#главное-отличие-от-пълдин-601)

[Фотография собранной печатной платы](#фотография-собранной-печатной-платы)

Функция|Описание
----|----
Процессор|HD63C03YP (мак. тактовая частота 3 МГц)
ОЗУ|128 КБ (статическое)
ПЗУ|128 КБ (электрически перепрограммируемое)
Порт ввода/вывода|14 бит, переконфигурируемые
Шина расширения|8 бит адрес, 8 бит данных, сигнал выбора окна периферии, прерывания, управление вводом/выводом

### Карта адресного пространства

Адрес|Назначение
----|----
F000-FFFF|BIOS ПЗУ/ОЗУ
E700-EFFF|ОЗУ
E600-E6FF|Внешние устройства (EXTCS)
E000-E5FF|ОЗУ
C000-DFFF|Страницы ОЗУ/ПЗУ
0028-BFFF|ОЗУ
0000-0027|HD6303 внутренние устройства

### Управление адресным пространством и страницами памяти
Переключение карты адресного пространства и страниц памяти производится через внутренний порт 6 процессора ($17). Распределение битов:

7|6|5|4|3|2|1|0
----|----|----|----|----|----|----|----
FN2|FN1|FN0|PA3|ROM|PA2|PA1|PA0

FN2-0 отвечает за выбор конфигурации адресного пространства. Текущая прошивка адресного декодера обеспечивает выбор ПЗУ в окне BIOS при 111 и ОЗУ во всех остальных случаях.

PA3-PA0 выбор страницы ОЗУ или ПЗУ. За тип выбранной страницы отвечает бит ROM (1 = ПЗУ).

Так как для ОЗУ и ПЗУ используют теже микросхемы, что и страницы памяти, то в страничной памяти возможно отображение дублирующих страниц ОЗУ или BIOS.

Для ОЗУ:

Страница|Адрес в процессорном пространстве
----|----
15|Нет
14|Нет
13|Нет
12|Нет
11|Нет
10|Нет
9|Нет
8|Нет
7|E000-EFFF (E000-FFFF если BIOS ПЗУ отключено)
6|C000-DFFF
5|A000-BFFF
4|8000-9FFF
3|6000-7FFF
2|4000-5FFF
1|2000-3FFF
0|0028-1FFF

Для ПЗУ

Страница|Адрес в процессорном пространстве
----|----
15|D000-DFFF = F000-FFFF для BIOS ПЗУ
0-14|Нет

### Шина расширения

Шина расширения предназначена для подключения дополнительной периферии к плате процессора.

Сигнал|Описание
----|----
RES|Сброс
NMI|Немаскируемое прерывание
IRQ1|Прерывание 1
IRQ2|Прерывание 2
E|Системная синхронизация
RW|Чтение/Запись
EXTCS|Обращение к пространству ввода-вывода (E600-E6FF)
ROMCS|Обращение к пространству BIOS (F000-FFFF)
D7-D0|Шина данных
A7-A0|Шина адреса

Шина адреса ограничена нижними 8-бит и предназначена для адресации периферийных регистров.

Расположение на плате:

Сигнал|Сигнал
----|----
GND|GND
RES|NMI
IRQ1|IRQ2
E|RW
EXTCS|ROMCS
D1|D0
D3|D2
D5|D4
D7|D6
A1|A0
A3|A2
A5|A4
A7|A6
+5V|+5V

### Порт ввода-вывода

Порт ввода-вывода включает в себя внутренние регистры процессора, незадействованные на процессорной плате.

Расположение на плате:

Сигнал|Назначение
----|----
GND|Земля
P20|Порт 2.0
P21|Порт 2.1
P22|Порт 2.2
P23RX|Порт 2.3 / Вход последовательного приемника
P24TX|Порт 2.4 / Выход последовательного передатчика
P25|Порт 2.5
P26|Порт 2.6
P27|Порт 2.7
P52|Порт 5.2
P53|Порт 5.3
P54|Порт 5.4
P55|Порт 5.5
P56|Порт 5.6
P57|Порт 5.7
+5V|Питание

### Главное отличие от Пълдин-601

Процессор HD6303 использует адреса 0000-0028 для доступа к внутренней периферии, поэтому ОЗУ по данным адресам не доступно. В связи с этим, системые переменные BIOS были перемещены в другое место. Программы, обращающие к этим переменным напрямую, должны быть исправлены(пересобраны) в соотвествии с новым файлом расположения переменных MEMORY.INC.

### Фотография собранной печатной платы

![board version 1.2](CPU-MEM-v1.2.jpg)

## Плата периферии

Текущая версия 1.2


